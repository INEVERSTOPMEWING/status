name: Website Monitor

on:
  schedule:
    - cron: '*/15 * * * *'  # alle 15 Minuten
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Repository auschecken
        uses: actions/checkout@v3

      - name: Prüfe Website
        id: ping
        run: |
          STATUS=$(curl -o /dev/null -s -w "%{http_code}" https://mattisweb.de)
          if [ "$STATUS" -eq 200 ]; then
            MESSAGE="Website ist OK ✅"
          else
            MESSAGE="Website ist DOWN ❌"
          fi
          echo $MESSAGE > status.html
          echo "::set-output name=status::$MESSAGE"

      - name: Commit & Push HTML-Datei
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add status.html
          git commit -m "Update Website Status" || echo "No changes to commit"
          git push
